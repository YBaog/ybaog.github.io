---
layout: post
title: 我眼中的MVC
categories: MVC
description: 我对mvc的认识
keywords: mvc
---
 ### 一、什么是MVC？

   MVC全名是Model View Controller，是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范，
   用一种业务逻辑、数据、界面显示分离的方法组织代码，将业务逻辑聚集到一个部件里面，在改进和个性化定制界面及用户交互的同时，
   不需要重新编写业务逻辑。MVC被独特的发展起来用于映射传统的输入、处理和输出功能在一个逻辑的图形化用户界面的结构中。


 ### 二、MVC 是如何工作

    MVC是一个设计模式，它强制性的使应用程序的输入、处理和输出分开。使用MVC应用程序被分成三个核心部件：模型、视图、控制器。它们各自处理自己的任务。        

- `Model`是指数据模型，是对客观事物的抽象。 如一篇博客文章，我们可能会以一个Post类来表示，那么，这个Post类就是数据对象。 同时，博客文章还有一些业务逻辑，如发布、回收、评论等，这一般表现为类的方法，这也是model的内容和范畴。 对于Model，主要是数据、业务逻辑和业务规则。相对而言，这是MVC中比较稳定的部分，一般成品后不会改变。 开发初期的最重要任务，主要也是实现Model的部分。这一部分写得好，后面就可以改得少，开发起来就快。
- `View`是指视图，也就是呈现给用户的一个界面，是model的具体表现形式，也是收集用户输入的地方。 如你在某个博客上看到的某一篇文章，就是某个Post类的表现形式。 View的目的在于提供与用户交互的界面。换句话说，对于用户而言，只有View是可见的、可操作的。 事实上也是如此，你不会让用户看到Model，更不会让他直接操作Model。 你只会让用户看到你想让他看的内容。 这就是View要做的事，他往往是MVC中变化频繁的部分，也是客户经常要求改来改去的地方。 今天你可能会以一种形式来展示你的博文，明天可能就变成别的表现形式了。
- `Contorller`指的是控制器，主要负责与model和view打交道。 换句话说，model和view之间一般不直接打交道，他们老死不相往来。view中不会对model作任何操作， model不会输出任何用于表现的东西，如HTML代码等。这俩甩手不干了，那总得有人来干吧，只能Controller上了。 Contorller用于决定使用哪些Model，对Model执行什么操作，为视图准备哪些数据，是MVC中沟通的桥梁。

### 三、为什么使用　ＭＶＣ

**1.能使网站程序物理结构更合理。**

当用PHP建设一个网站的时候，最笨的方法，你可能把每个页面建成一个PHP文件。如果你的网站只有index.php，menu.php.article.php 三个页面，那你可以不用MVC，但我们做一般的网站的时候，动辄几十个页面，把所有页面放在根目录显然不是我们所能接受的，于是你需要一个合理的思想去将你的代码分类，按功能把他们分成不同的目录，且由程序智能的载入调用，这就是MVC要帮助你做的。

**2.使代码更容易维护。**

我们再来看单个页面，最笨的方法，就是PHP代码与HTML代码混合，这显然不够好，你在维护网站的时候不得不区分哪里是PHP，哪里是HTML，这对于一个程序员来说，简直是灾难。于是很多人就使用Smarty，这样就可以将“数据处理”与“页面展示”分开来，这样做的确不错，也有很多人正在这么做，但这还不是MVC，MVC要做的就是将“数据处理”再分为“逻辑处理”与“数据库操作”，这就是所说的分层。
这样当你的程序错误或想要修改的时候，就变得很轻松了，当页面显示错误的时候，你就去检查V或模板文件；当逻辑有问题的时候，你就去检查C和V；当你数据库操作错误就去检查M。
其实MVC一般要把PHP的一个页面分割为4个页面，分别是C，V，M，模板。各司其职，方便管理。

**3.有利于代码复用。**

MVC会把一般会把一个大的功能放在一个目录下，也就是由一个C去管理。
例如要做一个含有会员系统的网站，我们就可以把会员相关的代码都放到user目录里，由User_Controller统一管理，当我们另一个网站也需要会员系统的时候，我们就可以直接把这个目录复制过去，修改一下接口就可以了。

### 四、PHP实现MVC的思路

我们需要三个基类：Controller、View、Model ，然后不同的C、V、M分别继承他们就有对应的属性与方法了，如果这里你不理解，可以去看看面向对象的书。

这里给大家提供一种MVC基类的设计思路，仅供参考：

**1. Controller类的设计**

一个main()方法，供程序调用，主要是通过get和post变量决定该如何处理。
一个getModel($model)方法，在需要调用数据库的时候，调用对应目录的M。
一个display($view)方法，在main()方法中调用，载入对应的V，并掉应V的main()方法；

**2.View类的设计与Controller很相似**

一个main()方法，当C载入V的时候调用这个方法，使程序能继续执行下去。
一个getModel($model)方法，在需要调用数据库的时候，调用对应目录的M。
一个display($template)，调用对应的模板文件，并把数据传递给模板。

**3.Model类的设计**

可以定义一些属性，例如要操作那些表，操作那些字段等。
> 一个getDB()方法，获得一个数据库类的实例，（数据库类一般都是用单件模式设计的）
> 一个load()方法，载入一个数据。
> 一个add()方法，可以根据定义好的属性自动构造SQL语句，并执行插入操作。
> 一个eidt()方法，同上，但执行修改操作。
> 一个del()方法，同上，但执行删除操作。
为了能使新手更好的理解我这个思路的工作原理，我们现在模拟一个用户登录的场景，看看MVC是如何工作的。
现在假设，所有的数据都提交给index.php，

- 第一步：
	我们提交各get变量，告诉index.php该用哪个C，例如可以这样index.php？controller=user
	然后index接收到get变量，什么也不需要做，直接找到/user/controller.php，把所有数据丢给他，本来GET和POST就是全局的，所以index.php也不需要做什么，直接调用C的main函数就可以了，到此index.php的任务完成。

- 第二步：
	C的main函数开始执行，检查变量，发现用户要执行的登录操作（很简单，你post个变量do=login就可以了），于是调用getModel，载入对应的M类（例如/user/models/model.php），并实例化， 调用实例的load方法，载入该用户的数据资料，判断是否与用户提交的密码一致，如果提交的数据不正确header跳转到出错页面，如果正确，调用display()方法，载入对应的V（例如/user/views/details.php），并实例化，调用其main()函数，进入第三步。到此C的任务已完成，第二不操作均在main函数中进行。

- 第三步：
	你可以选择调用getModel()载入M，重写调取数据，也可以在C实例化V的时候，把参数传过来（例如SESSION），当V已经确定得到数据以后，display()，载入模板，MVC执行完毕。
	当然，由于字数与精力限制，这里写的只是非常简要的概括，实际实施的时候要考虑很多细节，但我设计MVC的时候，大概思路就是这样，也用到了实际中，感觉良好。


### 五、MVC的优点和不足

**1-优点** 
1、可以为一个模型在运行时同时建立和使用多个视图。变化-传播机制可以确保所有相关的视图及时得到模型数据变化，从而使所有关联的视图和控制器做到行为同步。 
2、视图与控制器的可接插性，允许更换视图和控制器对象，而且可以根据需求动态的打开或关闭、甚至在运行期间进行对象替换。 
3、模型的可移植性。因为模型是独立于视图的，所以可以把一个模型独立地移植到新的平台工作。需要做的只是在新平台上对视图和控制器进行新的修改。 
4、潜在的框架结构。可以基于此模型建立应用程序框架，不仅仅是用在设计界面的设计中。 

**2-不足之处** 
1、增加了系统结构和实现的复杂性。对于简单的界面，严格遵循MVC，使模型、视图与控制器分离，会增加结构的复杂性，并可能产生过多的更新操作，降低运行效率。 
2、视图与控制器间的过于紧密的连接。视图与控制器是相互分离，但确实联系紧密的部件，视图没有控制器的存在，其应用是很有限的，反之亦然，这样就妨碍了他们的独立重用。 
3、视图对模型数据的低效率访问。依据模型操作接口的不同，视图可能需要多次调用才能获得足够的显示数据。对未变化数据的不必要的频繁访问，也将损害操作性能。 
4、目前，一般高级的界面工具或构造器不支持模式。改造这些工具以适应MVC需要和建立分离的部件的代价是很高的，从而造成MVC使用的困难。

   以上是我对MVC的认识，希望大家提出宝贵的意见！！！
